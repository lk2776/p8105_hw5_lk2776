---
title: "p1"
output: html_document
date: "2024-11-15"
---

#problem1 

Write a function that, for a fixed group size, randomly draws “birthdays” for each person; checks whether there are duplicate birthdays in the group; and returns TRUE or FALSE based on the result.


```{r}
b_day_func = function(group_size) {
  #random birthday generation for each group
  sim_b_data = sample(1:365, group_size, replace=TRUE)
  
  any(duplicated(sim_b_data)) #check - one output 
}

b_day_func(1)
b_day_func(100)

```

Next, run this function 10000 times for each group size between 2 and 50. For each group size, compute the probability that at least two people in the group will share a birthday by averaging across the 10000 simulation runs. Make a plot showing the probability as a function of group size, and comment on your results.

```{r}
sim_results_df_p1 = 
  expand_grid(
    group_sizes = seq(2,50),
    iter = 1:10000) |>
  mutate(
    output_p1 = map_lgl(group_sizes, \(x) b_day_func(x))
    ) |>
   group_by(group_sizes) |>
  summarize(prob_dup = mean(output_p1)) |>
  ggplot(aes(x = group_sizes, y = prob_dup)) + 
       geom_point(color="blue") + 
         geom_line(color="orange") +
  labs(
    title = "probablity of duplicate birthdays vs group size",
    x = "group size",
    y = "prob of duplicate birthdays"
  )
#plot_data = sim_results_df_p1 |>

```

