---
title: "problem3"
output: html_document
date: "2024-11-15"
---

```{r}
library(tidyverse)
library(purrr)
library(broom)
```


```{r}
#read data
data = read_csv("./data/homicide-data.csv") |>
  janitor::clean_names() |>
  drop_na() |>
  mutate(city_state = paste(city, state, sep="_"), 
         not_solved = if_else(
           disposition %in% c("Closed without arrest", "Open/No arrest"), 1, 0))  # if match, add 1, otherwise, add 0. 
```

```{r}
summary_data = data |>
  group_by(city_state) |>
  summarize(
    total_number_of_homicides = n(), #count
    unsolved_homicides = sum(not_solved) 
  ) #|>
  #knitr::kable()
```

```{r}
summary_data_balti = summary_data |>
  filter(city_state == "Baltimore_MD") 
  
prop_test_out <- prop.test(summary_data_balti$unsolved_homicides, summary_data_balti$total_number_of_homicides) 

tidy(prop_test_out) |> 
  select(estimate,conf.low,conf.high) 

 # mutate(est_prop = estimate[1], 
  #       low_conf = conf.low[1],
   #      high_conf = conf.high[1]) 
```

